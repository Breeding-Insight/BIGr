% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check_madc_sanity.R
\name{check_madc_sanity}
\alias{check_madc_sanity}
\title{Run basic sanity checks on a MADC-style allele report}
\usage{
check_madc_sanity(report)
}
\arguments{
\item{report}{A \code{data.frame} with at least the columns
\code{CloneID}, \code{AlleleID}, and \code{AlleleSequence}. The first column is also
used in the “FixAlleleIDs” check to inspect its first up to six entries.}
}
\value{
A list with:
\describe{
\item{checks}{Named logical vector with entries
\code{Columns}, \code{FixAlleleIDs}, \code{IUPACcodes}, \code{LowerCase}, \code{Indels}.}
\item{indel_clone_ids}{Character vector of \code{CloneID}s where ref/alt lengths differ.
Returns \code{character(0)} if none, or \code{NULL} when required columns are missing.}
}
}
\description{
Performs five quick validations on an allele report:
\enumerate{
\item \strong{Columns} – required columns are present (\code{CloneID}, \code{AlleleID}, \code{AlleleSequence});
\item \strong{FixAlleleIDs} – first column’s first up-to-6 rows are not all blank or "*"
\emph{and} both \verb{_0001} and \verb{_0002} appear in \code{AlleleID};
\item \strong{IUPACcodes} – presence of non-ATCG characters in \code{AlleleSequence};
\item \strong{LowerCase} – presence of lowercase a/t/c/g in \code{AlleleSequence};
\item \strong{Indels} – reference/alternate allele lengths differ for the same \code{CloneID}.
}
}
\details{
\itemize{
\item \strong{IUPAC check:} Flags any character outside \code{ATCG} (case-insensitive),
which will include ambiguity codes (\code{N}, \code{R}, \code{Y}, etc.) and symbols like \code{-}.
\item \strong{Indels:} Rows are split by \code{AlleleID} containing \code{"Ref_0001"} vs \code{"Alt_0002"},
merged by \code{CloneID}, and the lengths of \code{AlleleSequence} are compared.
\item If required columns are missing, only \strong{Columns} is evaluated (\code{FALSE}) and
\code{indel_clone_ids} is returned as \code{NULL}.
}
}
